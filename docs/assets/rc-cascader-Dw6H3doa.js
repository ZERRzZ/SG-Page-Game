import{K as oe,z as Ie,i as be}from"./rc-util-C9ivse0O.js";import{f as ee,e as re,b as W,d as He,c as G,g as Ae,h as hn}from"./@babel-CFFMjQWX.js";import{u as pn,b as mn,B as gn}from"./rc-select-EbswYp37.js";import{r as o}from"./react-s7AnpVDj.js";import{c as Cn,a as Le}from"./rc-tree-DLK9jCvq.js";import{c as ke}from"./classnames-BK5ccKcQ.js";import"./react-is-DcfIKM1A.js";import"./rc-overflow-DRCnfb5s.js";import"./react-dom-CKXDipwq.js";import"./rc-resize-observer-CnQCMlPW.js";import"./rc-motion-DyAdOdRG.js";var me=o.createContext(null),fe="__rc_cascader_search_mark__",Sn=function(a,n,t){var r=t.label;return n.some(function(i){return String(i[r]).toLowerCase().includes(a.toLowerCase())})},bn=function(a,n,t,r){return n.map(function(i){return i[r.label]}).join(" / ")};const yn=function(e,a,n,t,r,i){var u=r.filter,l=u===void 0?Sn:u,c=r.render,s=c===void 0?bn:c,g=r.limit,d=g===void 0?50:g,h=r.sort;return o.useMemo(function(){var C=[];if(!e)return[];function v(m,k){var M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;m.forEach(function(p){if(!(!h&&d!==!1&&d>0&&C.length>=d)){var A=[].concat(ee(k),[p]),D=p[n.children],K=M||p.disabled;if((!D||D.length===0||i)&&l(e,A,{label:n.label})){var V;C.push(re(re({},p),{},(V={disabled:K},W(V,n.label,s(e,A,t,n)),W(V,fe,A),W(V,n.children,void 0),V)))}D&&v(p[n.children],A,K)}})}return v(a,[]),h&&C.sort(function(m,k){return h(m[fe],k[fe],e,n)}),d!==!1&&d>0?C.slice(0,d):C},[e,a,n,t,s,i,l,h,d])};var De="__RC_CASCADER_SPLIT__",We="SHOW_PARENT",Fe="SHOW_CHILD";function ne(e){return e.join(De)}function he(e){return e.map(ne)}function kn(e){return e.split(De)}function Be(e){var a=e||{},n=a.label,t=a.value,r=a.children,i=t||"value";return{label:n||"label",value:i,key:i,children:r||"children"}}function Ce(e,a){var n,t;return(n=e.isLeaf)!==null&&n!==void 0?n:!((t=e[a.children])!==null&&t!==void 0&&t.length)}function Vn(e){var a=e.parentElement;if(a){var n=e.offsetTop-a.offsetTop;n-a.scrollTop<0?a.scrollTo({top:n}):n+e.offsetHeight-a.scrollTop>a.offsetHeight&&a.scrollTo({top:n+e.offsetHeight-a.offsetHeight})}}function Ue(e,a){return e.map(function(n){var t;return(t=n[fe])===null||t===void 0?void 0:t.map(function(r){return r[a.value]})})}function xn(e){return Array.isArray(e)&&Array.isArray(e[0])}function ye(e){return e?xn(e)?e:(e.length===0?[]:[e]).map(function(a){return Array.isArray(a)?a:[a]}):[]}function je(e,a,n){var t=new Set(e),r=a();return e.filter(function(i){var u=r[i],l=u?u.parent:null,c=u?u.children:null;return u&&u.node.disabled?!0:n===Fe?!(c&&c.some(function(s){return s.key&&t.has(s.key)})):!(l&&!l.node.disabled&&t.has(l.key))})}function pe(e,a,n){for(var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,r=a,i=[],u=function(){var s,g,d,h=e[l],C=(s=r)===null||s===void 0?void 0:s.findIndex(function(m){var k=m[n.value];return t?String(k)===String(h):k===h}),v=C!==-1?(g=r)===null||g===void 0?void 0:g[C]:null;i.push({value:(d=v==null?void 0:v[n.value])!==null&&d!==void 0?d:h,index:C,option:v}),r=v==null?void 0:v[n.children]},l=0;l<e.length;l+=1)u();return i}const _n=function(e,a,n,t,r){return o.useMemo(function(){var i=r||function(u){var l=t?u.slice(-1):u,c=" / ";return l.every(function(s){return["string","number"].includes(He(s))})?l.join(c):l.reduce(function(s,g,d){var h=o.isValidElement(g)?o.cloneElement(g,{key:d}):g;return d===0?[h]:[].concat(ee(s),[c,h])},[])};return e.map(function(u){var l,c=pe(u,a,n),s=i(c.map(function(d){var h,C=d.option,v=d.value;return(h=C==null?void 0:C[n.label])!==null&&h!==void 0?h:v}),c.map(function(d){var h=d.option;return h})),g=ne(u);return{label:s,value:g,key:g,valueCells:u,disabled:(l=c[c.length-1])===null||l===void 0||(l=l.option)===null||l===void 0?void 0:l.disabled}})},[e,a,n,r,t])};function Je(e,a){return o.useCallback(function(n){var t=[],r=[];return n.forEach(function(i){var u=pe(i,e,a);u.every(function(l){return l.option})?r.push(i):t.push(i)}),[r,t]},[e,a])}const On=function(e,a){var n=o.useRef({options:null,info:null}),t=o.useCallback(function(){return n.current.options!==e&&(n.current.options=e,n.current.info=Cn(e,{fieldNames:a,initWrapper:function(i){return re(re({},i),{},{pathKeyEntities:{}})},processEntity:function(i,u){var l=i.nodes.map(function(c){return c[a.value]}).join(De);u.pathKeyEntities[l]=i,i.key=l}})),n.current.info.pathKeyEntities},[a,e]);return t};function Xe(e,a){var n=o.useMemo(function(){return a||[]},[a]),t=On(n,e),r=o.useCallback(function(i){var u=t();return i.map(function(l){var c=u[l].nodes;return c.map(function(s){return s[e.value]})})},[t,e]);return[n,t,r]}function Pn(e){return o.useMemo(function(){if(!e)return[!1,{}];var a={matchInputWidth:!0,limit:50};return e&&He(e)==="object"&&(a=re(re({},a),e)),a.limit<=0&&delete a.limit,[!0,a]},[e])}function qe(e,a,n,t,r,i,u,l){return function(c){if(!e)a(c);else{var s=ne(c),g=he(n),d=he(t),h=g.includes(s),C=r.some(function(V){return ne(V)===s}),v=n,m=r;if(C&&!h)m=r.filter(function(V){return ne(V)!==s});else{var k=h?g.filter(function(V){return V!==s}):[].concat(ee(g),[s]),M=i(),p;if(h){var A=Le(k,{checked:!1,halfCheckedKeys:d},M);p=A.checkedKeys}else{var D=Le(k,!0,M);p=D.checkedKeys}var K=je(p,i,l);v=u(K)}a([].concat(ee(m),ee(v)))}}}function ze(e,a,n,t,r){return o.useMemo(function(){var i=r(a),u=G(i,2),l=u[0],c=u[1];if(!e||!a.length)return[l,[],c];var s=he(l),g=n(),d=Le(s,!0,g),h=d.checkedKeys,C=d.halfCheckedKeys;return[t(h),t(C),c]},[e,a,n,t,r])}var En=o.memo(function(e){var a=e.children;return a},function(e,a){return!a.open});function wn(e){var a,n=e.prefixCls,t=e.checked,r=e.halfChecked,i=e.disabled,u=e.onClick,l=e.disableCheckbox,c=o.useContext(me),s=c.checkable,g=typeof s!="boolean"?s:null;return o.createElement("span",{className:ke("".concat(n),(a={},W(a,"".concat(n,"-checked"),t),W(a,"".concat(n,"-indeterminate"),!t&&r),W(a,"".concat(n,"-disabled"),i||l),a)),onClick:u},g)}var Ge="__cascader_fix_label__";function Mn(e){var a=e.prefixCls,n=e.multiple,t=e.options,r=e.activeValue,i=e.prevValuePath,u=e.onToggleOpen,l=e.onSelect,c=e.onActive,s=e.checkedSet,g=e.halfCheckedSet,d=e.loadingKeys,h=e.isSelectable,C=e.searchValue,v="".concat(a,"-menu"),m="".concat(a,"-menu-item"),k=o.useContext(me),M=k.fieldNames,p=k.changeOnSelect,A=k.expandTrigger,D=k.expandIcon,K=k.loadingIcon,V=k.dropdownMenuColumnStyle,S=k.optionRender,w=A==="hover",x=o.useMemo(function(){return t.map(function(f){var b,P=f.disabled,N=f.disableCheckbox,$=f[fe],I=(b=f[Ge])!==null&&b!==void 0?b:f[M.label],F=f[M.value],B=Ce(f,M),J=$?$.map(function(Y){return Y[M.value]}):[].concat(ee(i),[F]),O=ne(J),U=d.includes(O),j=s.has(O),H=g.has(O);return{disabled:P,label:I,value:F,isLeaf:B,isLoading:U,checked:j,halfChecked:H,option:f,disableCheckbox:N,fullPath:J,fullPathKey:O}})},[t,s,M,g,d,i]);return o.createElement("ul",{className:v,role:"menu"},x.map(function(f){var b,P=f.disabled,N=f.label,$=f.value,I=f.isLeaf,F=f.isLoading,B=f.checked,J=f.halfChecked,O=f.option,U=f.fullPath,j=f.fullPathKey,H=f.disableCheckbox,Y=function(){if(!(P||C)){var X=ee(U);w&&I&&X.pop(),c(X)}},Q=function(){h(O)&&l(U,I)},ae;return typeof O.title=="string"?ae=O.title:typeof N=="string"&&(ae=N),o.createElement("li",{key:j,className:ke(m,(b={},W(b,"".concat(m,"-expand"),!I),W(b,"".concat(m,"-active"),r===$||r===j),W(b,"".concat(m,"-disabled"),P),W(b,"".concat(m,"-loading"),F),b)),style:V,role:"menuitemcheckbox",title:ae,"aria-checked":B,"data-path-key":j,onClick:function(){Y(),!H&&(!n||I)&&Q()},onDoubleClick:function(){p&&u(!1)},onMouseEnter:function(){w&&Y()},onMouseDown:function(X){X.preventDefault()}},n&&o.createElement(wn,{prefixCls:"".concat(a,"-checkbox"),checked:B,halfChecked:J,disabled:P||H,disableCheckbox:H,onClick:function(X){H||(X.stopPropagation(),Q())}}),o.createElement("div",{className:"".concat(m,"-content")},S?S(O):N),!F&&D&&!I&&o.createElement("div",{className:"".concat(m,"-expand-icon")},D),F&&K&&o.createElement("div",{className:"".concat(m,"-loading-icon")},K))}))}const In=function(e,a){var n=o.useContext(me),t=n.values,r=t[0],i=o.useState([]),u=G(i,2),l=u[0],c=u[1];return o.useEffect(function(){a&&!e&&c(r||[])},[a,r]),[l,c]},Ln=function(e,a,n,t,r,i,u){var l=u.direction,c=u.searchValue,s=u.toggleOpen,g=u.open,d=l==="rtl",h=o.useMemo(function(){for(var V=-1,S=a,w=[],x=[],f=t.length,b=Ue(a,n),P=function(B){var J=S.findIndex(function(O,U){return(b[U]?ne(b[U]):O[n.value])===t[B]});if(J===-1)return 1;V=J,w.push(V),x.push(t[B]),S=S[V][n.children]},N=0;N<f&&S&&!P(N);N+=1);for(var $=a,I=0;I<w.length-1;I+=1)$=$[w[I]][n.children];return[x,V,$,b]},[t,n,a]),C=G(h,4),v=C[0],m=C[1],k=C[2],M=C[3],p=function(S){r(S)},A=function(S){var w=k.length,x=m;x===-1&&S<0&&(x=w);for(var f=0;f<w;f+=1){x=(x+S+w)%w;var b=k[x];if(b&&!b.disabled){var P=v.slice(0,-1).concat(M[x]?ne(M[x]):b[n.value]);p(P);return}}},D=function(){if(v.length>1){var S=v.slice(0,-1);p(S)}else s(!1)},K=function(){var S,w=((S=k[m])===null||S===void 0?void 0:S[n.children])||[],x=w.find(function(b){return!b.disabled});if(x){var f=[].concat(ee(v),[x[n.value]]);p(f)}};o.useImperativeHandle(e,function(){return{onKeyDown:function(S){var w=S.which;switch(w){case oe.UP:case oe.DOWN:{var x=0;w===oe.UP?x=-1:w===oe.DOWN&&(x=1),x!==0&&A(x);break}case oe.LEFT:{if(c)break;d?K():D();break}case oe.RIGHT:{if(c)break;d?D():K();break}case oe.BACKSPACE:{c||D();break}case oe.ENTER:{if(v.length){var f=k[m],b=(f==null?void 0:f[fe])||[];b.length?i(b.map(function(P){return P[n.value]}),b[b.length-1]):i(v,k[m])}break}case oe.ESC:s(!1),g&&S.stopPropagation()}},onKeyUp:function(){}}})};var Ye=o.forwardRef(function(e,a){var n,t,r,i=e.prefixCls,u=e.multiple,l=e.searchValue,c=e.toggleOpen,s=e.notFoundContent,g=e.direction,d=e.open,h=o.useRef(),C=g==="rtl",v=o.useContext(me),m=v.options,k=v.values,M=v.halfValues,p=v.fieldNames,A=v.changeOnSelect,D=v.onSelect,K=v.searchOptions,V=v.dropdownPrefixCls,S=v.loadData,w=v.expandTrigger,x=V||i,f=o.useState([]),b=G(f,2),P=b[0],N=b[1],$=function(y){if(!(!S||l)){var _=pe(y,m,p),E=_.map(function(ce){var te=ce.option;return te}),R=E[E.length-1];if(R&&!Ce(R,p)){var ue=ne(y);N(function(ce){return[].concat(ee(ce),[ue])}),S(E)}}};o.useEffect(function(){P.length&&P.forEach(function(L){var y=kn(L),_=pe(y,m,p,!0).map(function(R){var ue=R.option;return ue}),E=_[_.length-1];(!E||E[p.children]||Ce(E,p))&&N(function(R){return R.filter(function(ue){return ue!==L})})})},[m,P,p]);var I=o.useMemo(function(){return new Set(he(k))},[k]),F=o.useMemo(function(){return new Set(he(M))},[M]),B=In(u,d),J=G(B,2),O=J[0],U=J[1],j=function(y){U(y),$(y)},H=function(y){var _=y.disabled,E=Ce(y,p);return!_&&(E||A||u)},Y=function(y,_){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;D(y),!u&&(_||A&&(w==="hover"||E))&&c(!1)},Q=o.useMemo(function(){return l?K:m},[l,K,m]),ae=o.useMemo(function(){for(var L=[{options:Q}],y=Q,_=Ue(y,p),E=function(){var ce=O[R],te=y.find(function(Ve,Se){return(_[Se]?ne(_[Se]):Ve[p.value])===ce}),se=te==null?void 0:te[p.children];if(!(se!=null&&se.length))return 1;y=se,L.push({options:se})},R=0;R<O.length&&!E();R+=1);return L},[Q,O,p]),T=function(y,_){H(_)&&Y(y,Ce(_,p),!0)};Ln(a,Q,p,O,j,T,{direction:g,searchValue:l,toggleOpen:c,open:d}),o.useEffect(function(){for(var L=0;L<O.length;L+=1){var y,_=O.slice(0,L+1),E=ne(_),R=(y=h.current)===null||y===void 0?void 0:y.querySelector('li[data-path-key="'.concat(E.replace(/\\{0,2}"/g,'\\"'),'"]'));R&&Vn(R)}},[O]);var X=!((n=ae[0])!==null&&n!==void 0&&(n=n.options)!==null&&n!==void 0&&n.length),le=[(t={},W(t,p.value,"__EMPTY__"),W(t,Ge,s),W(t,"disabled",!0),t)],ve=re(re({},e),{},{multiple:!X&&u,onSelect:Y,onActive:j,onToggleOpen:c,checkedSet:I,halfCheckedSet:F,loadingKeys:P,isSelectable:H}),ie=X?[{options:le}]:ae,z=ie.map(function(L,y){var _=O.slice(0,y),E=O[y];return o.createElement(Mn,Ae({key:y},ve,{searchValue:l,prefixCls:x,options:L.options,prevValuePath:_,activeValue:E}))});return o.createElement(En,{open:d},o.createElement("div",{className:ke("".concat(x,"-menus"),(r={},W(r,"".concat(x,"-menu-empty"),X),W(r,"".concat(x,"-rtl"),C),r)),ref:h},z))}),An=o.forwardRef(function(e,a){var n=pn();return o.createElement(Ye,Ae({},e,n,{ref:a}))});function Dn(){}function Rn(e){var a,n=e,t=n.prefixCls,r=t===void 0?"rc-cascader":t,i=n.style,u=n.className,l=n.options,c=n.checkable,s=n.defaultValue,g=n.value,d=n.fieldNames,h=n.changeOnSelect,C=n.onChange,v=n.showCheckedStrategy,m=n.loadData,k=n.expandTrigger,M=n.expandIcon,p=M===void 0?">":M,A=n.loadingIcon,D=n.direction,K=n.notFoundContent,V=K===void 0?"Not Found":K,S=!!c,w=Ie(s,{value:g,postState:ye}),x=G(w,2),f=x[0],b=x[1],P=o.useMemo(function(){return Be(d)},[JSON.stringify(d)]),N=Xe(P,l),$=G(N,3),I=$[0],F=$[1],B=$[2],J=Je(I,P),O=ze(S,f,F,B,J),U=G(O,3),j=U[0],H=U[1],Y=U[2],Q=be(function(ie){if(b(ie),C){var z=ye(ie),L=z.map(function(E){return pe(E,I,P).map(function(R){return R.option})}),y=S?z:z[0],_=S?L:L[0];C(y,_)}}),ae=qe(S,Q,j,H,Y,F,B,v),T=be(function(ie){ae(ie)}),X=o.useMemo(function(){return{options:I,fieldNames:P,values:j,halfValues:H,changeOnSelect:h,onSelect:T,checkable:c,searchOptions:[],dropdownPrefixCls:null,loadData:m,expandTrigger:k,expandIcon:p,loadingIcon:A,dropdownMenuColumnStyle:null}},[I,P,j,H,h,T,c,m,k,p,A]),le="".concat(r,"-panel"),ve=!I.length;return o.createElement(me.Provider,{value:X},o.createElement("div",{className:ke(le,(a={},W(a,"".concat(le,"-rtl"),D==="rtl"),W(a,"".concat(le,"-empty"),ve),a),u),style:i},ve?V:o.createElement(Ye,{prefixCls:r,searchValue:null,multiple:S,toggleOpen:Dn,open:!0,direction:D})))}var Tn=["id","prefixCls","fieldNames","defaultValue","value","changeOnSelect","onChange","displayRender","checkable","autoClearSearchValue","searchValue","onSearch","showSearch","expandTrigger","options","dropdownPrefixCls","loadData","popupVisible","open","popupClassName","dropdownClassName","dropdownMenuColumnStyle","dropdownStyle","popupPlacement","placement","onDropdownVisibleChange","onPopupVisibleChange","expandIcon","loadingIcon","children","dropdownMatchSelectWidth","showCheckedStrategy","optionRender"],Re=o.forwardRef(function(e,a){var n=e.id,t=e.prefixCls,r=t===void 0?"rc-cascader":t,i=e.fieldNames,u=e.defaultValue,l=e.value,c=e.changeOnSelect,s=e.onChange,g=e.displayRender,d=e.checkable,h=e.autoClearSearchValue,C=h===void 0?!0:h,v=e.searchValue,m=e.onSearch,k=e.showSearch,M=e.expandTrigger,p=e.options,A=e.dropdownPrefixCls,D=e.loadData,K=e.popupVisible,V=e.open,S=e.popupClassName,w=e.dropdownClassName,x=e.dropdownMenuColumnStyle,f=e.dropdownStyle,b=e.popupPlacement,P=e.placement,N=e.onDropdownVisibleChange,$=e.onPopupVisibleChange,I=e.expandIcon,F=I===void 0?">":I,B=e.loadingIcon,J=e.children,O=e.dropdownMatchSelectWidth,U=O===void 0?!1:O,j=e.showCheckedStrategy,H=j===void 0?We:j,Y=e.optionRender,Q=hn(e,Tn),ae=mn(n),T=!!d,X=Ie(u,{value:l,postState:ye}),le=G(X,2),ve=le[0],ie=le[1],z=o.useMemo(function(){return Be(i)},[JSON.stringify(i)]),L=Xe(z,p),y=G(L,3),_=y[0],E=y[1],R=y[2],ue=Ie("",{value:v,postState:function(q){return q||""}}),ce=G(ue,2),te=ce[0],se=ce[1],Ve=function(q,de){se(q),de.source!=="blur"&&m&&m(q)},Se=Pn(k),Te=G(Se,2),Qe=Te[0],Ke=Te[1],xe=yn(te,_,z,A||r,Ke,c),Ze=Je(_,z),en=ze(T,ve,E,R,Ze),_e=G(en,3),ge=_e[0],Oe=_e[1],Pe=_e[2],nn=o.useMemo(function(){var Z=he(ge),q=je(Z,E,H);return[].concat(ee(Pe),ee(R(q)))},[ge,E,R,Pe,H]),an=_n(nn,_,z,T,g),Ne=be(function(Z){if(ie(Z),s){var q=ye(Z),de=q.map(function(vn){return pe(vn,_,z).map(function(fn){return fn.option})}),we=T?q:q[0],Me=T?de:de[0];s(we,Me)}}),tn=qe(T,Ne,ge,Oe,Pe,E,R,H),Ee=be(function(Z){(!T||C)&&se(""),tn(Z)}),rn=function(q,de){if(de.type==="clear"){Ne([]);return}var we=de.values[0],Me=we.valueCells;Ee(Me)},on=V!==void 0?V:K,ln=w||S,un=P||b,cn=function(q){N==null||N(q),$==null||$(q)},sn=o.useMemo(function(){return{options:_,fieldNames:z,values:ge,halfValues:Oe,changeOnSelect:c,onSelect:Ee,checkable:d,searchOptions:xe,dropdownPrefixCls:A,loadData:D,expandTrigger:M,expandIcon:F,loadingIcon:B,dropdownMenuColumnStyle:x,optionRender:Y}},[_,z,ge,Oe,c,Ee,d,xe,A,D,M,F,B,x,Y]),$e=!(te?xe:_).length,dn=te&&Ke.matchInputWidth||$e?{}:{minWidth:"auto"};return o.createElement(me.Provider,{value:sn},o.createElement(gn,Ae({},Q,{ref:a,id:ae,prefixCls:r,autoClearSearchValue:C,dropdownMatchSelectWidth:U,dropdownStyle:re(re({},dn),f),displayValues:an,onDisplayValuesChange:rn,mode:T?"multiple":void 0,searchValue:te,onSearch:Ve,showSearch:Qe,OptionList:An,emptyOptions:$e,open:on,dropdownClassName:ln,placement:un,onDropdownVisibleChange:cn,getRawInputElement:function(){return J}})))});Re.SHOW_PARENT=We;Re.SHOW_CHILD=Fe;Re.Panel=Rn;export{Re as C,Rn as P};
